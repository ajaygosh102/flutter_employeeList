import 'package:floges_flutter_app/config/theme.dart';import 'package:floges_flutter_app/data/global_data.dart';import 'package:floges_flutter_app/presentation/widgets/circle_progressbar.dart';import 'package:flutter/material.dart';import 'package:flutter_bloc/flutter_bloc.dart';import 'bloc/home_bloc_cubit.dart';class HomeScreen extends StatefulWidget {  @override  _HomeScreenState createState() => _HomeScreenState();}class _HomeScreenState extends State<HomeScreen> {  HomeBlocCubit homeBlocCubit = HomeBlocCubit();  int pageCount = 1;  @override  void initState() {    homeBlocCubit.getEmployees(params: {'page': pageCount.toString()});    super.initState();  }  @override  Widget build(BuildContext context) {    return Scaffold(        backgroundColor: Colors.white,        appBar: AppBar(          title: Text(            'Employees List ',            style: Theme.of(context).textTheme.subtitle1,          ),        ),        body: SingleChildScrollView(          child: Column(            children: [              ListView.builder(                physics: NeverScrollableScrollPhysics(),                shrinkWrap: true,                itemCount: GlobalData?.homeDataModel?.data?.length ?? 0,                itemBuilder: (context, index) => ListTile(                  title: Text(                    GlobalData?.homeDataModel?.data[index]?.firstName ?? '',                    style: Theme.of(context).textTheme.subtitle1,                  ),                  subtitle: Text(                    GlobalData?.homeDataModel?.data[index]?.email ?? "",                    style: Theme.of(context).textTheme.bodyText2,                  ),                  leading: CircleAvatar(                    maxRadius: 24,                    backgroundImage: NetworkImage(                        GlobalData?.homeDataModel?.data[index]?.avatar ?? ''),                  ),                ),              ),              BlocBuilder(                  cubit: homeBlocCubit,                  builder: (context, state) {                    if (state is Loading) {                      return showCircleProgress();                    }                    if (state is HomeDataResponse) {                      WidgetsBinding.instance.addPostFrameCallback((_) {                        setState(() {                          GlobalData.homeDataModel = state.homeDataModel;                        });                      });                    }                    return FlatButton(                      disabledColor: AppColors.darkGray,                      color: Colors.blue,                      child: Text(                        state.homeDataModel.totalPages > pageCount?'Load Page ${pageCount + 1}':'Max page reached',                        style: Theme.of(context).textTheme.button,                      ),                      onPressed: state.homeDataModel.totalPages > pageCount                          ? () {                              setState(() {                                pageCount++;                              });                              homeBlocCubit.getEmployees(                                  params: {'page': pageCount.toString()});                            }                          : null,                    );                  })            ],          ),        ));  }}